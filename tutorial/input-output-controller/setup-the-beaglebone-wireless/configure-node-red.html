<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="/default.css" media="screen" />
		<link rel="shortcut icon" href="/img/yggdrasil.ico">
		<title>yggdrasilView</title>
	</head>
	<body  >
		<div class="container">
			<div class="main">
				<div class="header">
					<div class="title">
						<h1>yggdrasilView</h1>
					</div>
				</div>
				<div class="content">
					<div class="item">
						<h1>Configure Node-Red</h1>
						<ul>
						 	<li>We will use <a href="https://nodered.org/" target="_blank" rel="noopener">Node-Red</a> for the programming the BBBW</li>
						 	<li>Node-Red is already installed on the BBBW but we will need to add some libraries
								<ul>
								 	<li>Log in as root into the BBBW</li>
								 	<li>Change the directory to node-red
										<ul>
										 	<li>$ <strong>cd .node-red</strong></li>
										</ul>
									</li>
						 			<li>Update the software repositopries
										<ul>
						 					<li>$ <strong>sudo apt-get update</strong></li>
										</ul>
									</li>
						 			<li>Install <a href="https://github.com/julianduque/beaglebone-io" target="_blank" rel="noopener">BeagleBone-IO</a>
										<ul>
						 					<li>$ <strong>sudo npm install beaglebone-io</strong></li>
										</ul>
									</li>
						 			<li>Install <a href="https://github.com/monteslu/node-red-contrib-gpio" target="_blank" rel="noopener">node-red-contrib-gpio</a>
										<ul>
						 					<li>$ <strong>sudo npm install node-red-contrib-gpio</strong></li>
										</ul>
									</li>
						 			<li>Install the <a href="https://github.com/node-red/node-red-dashboard" target="_blank" rel="noopener">node-red-dashboard</a>
										<ul>
						 					<li>$ <strong>sudo npm install node-red-dashboard</strong></li>
										</ul>
									</li>
								</ul>
							</li>
						 	<li>Node-Red is browser based and initially, access to the browser does not require a password.
								<ul>
						 			<li>This is fine if you plan to operate the BBBW behind a secure firewall.</li>
						 			<li>Otherwise it is recommended to password protect node-red
										<ul>
						 					<li>edit the settings.js file in the root .node-red directory.</li>
						 					<li>$ <strong>nano settings.js</strong></li>
						 					<li>To password protect the node-red editor (highly recommended) Un-comment lines 107-114
												<ul>
						 							<li><img src="/images/tutorial/node-redAdminPwProtect.png" width="747" height="244" /></li>
						 							<li>The password is bcrypted for the password "password".
														<ul>
						 									<li>Obviously it is best to change this.</li>
						 									<li>You can use plain text better it is better to hash it.</li>
						 									<li>There are many bcrypt calculators.
																<ul>
						 											<li>I use the one at <a href="https://bcrypt-generator.com" target="_blank" rel="noopener">bcrypt-generator.com</a></li>
																</ul>
															</li>
														</ul>
													</li>
												</ul>
											</li>
						 					<li>To password protect any web pages the BBBW might serve through node-red, un-comment lines 120-121
												<ul>
						 							<li><span style="color: #00ffff;"><strong><img src="/images/tutorial/node-redWebPwProtect.png" width="861" height="150" /></strong></span></li>
												</ul>
											</li>
										</ul>
									</li>
								</ul>
							</li>
						 	<li>Change the default file name.
								<ul>
						 			<li>Node-Red stores the programs in a <a href="https://www.json.org/" target="_blank" rel="noopener">json</a> files called a flow.</li>
						 			<li>In the initial configuration node-red appends the hostname to boot flow file.
										<ul>
						 					<li>For version control this can be annoying.</li>
						 					<li>I uncomment out line 53:
												<ul>
						 							<li><div>flowFile: 'flows.json',</div></li>
												</ul>
											</li>
						 					<li>For ease of reading the flows in a repository, I also uncomment line 57
												<ul>
						 							<li>flowFilePretty: true,</li>
												</ul>
											</li>
										</ul>
									</li>
								</ul>
							</li>
						 	<li>Reset the BBBW by pressing S1 (or power cycle)  to load the new installations
								<ul>
						 			<li>Open a browser and enter into the address bar:
										<ul>
						 					<li>http://hostname.local:1880
												<ul>
						 							<li>where hostname is the hostname of your BBBW</li>
												</ul>
											</li>
					 						<li>You should get the following splash screen</li>
						 					<li><a href="/images/tutorial/node-red-splash.png" target="_blank"><img src="/images/tutorial/node-red-splash.png" width="341" height="250" /></a></li>
						 					<li>After entering the user name and  password you put into the settings.js file, you should see the Node-Red desktop</li>
						 					<li><a href="/images/tutorial/node-red_blank.png" target="_blank"><img src="/images/tutorial/node-red_blank.png" alt="" width="331" height="250" /></a></li>
										</ul>
									</li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<div class="sidenav">
				<a href="/index.html"><h1>Overview</h1></a>
				<ul>
					<li><a href="/services.html">Services</a></li>
					<li><a href="/solutions.html">Solutions</a></li>
					<li><a href="/tutorial.html">Tutorial</a></li>
				</ul>
				<a href="/tutorial.html"><h1>Tutorial</h1></a>
				<ul>
				 	<li><a href="/tutorial/test-device-design.html">Test Device Design</a></li>
				 	<li><a href="/tutorial/setup-mqtt.html">Setup MQTT</a></li>
				 	<li><a href="/tutorial/input-output-controller.html">IOC with a BBBW</a></li>
				 	<li><a href="/tutorial/node-red-web-application.html">Node-Red Web Application</a></li>
				</ul>
				<a href="/tutorial/input-output-controller.html"><h1>IOC with a BBBW</h1></a>
				<ul>
				 	<li><a href="/tutorial/input-output-controller/setup-the-beaglebone-wireless.html">Setup the BBBW</a></li>
				 	<li><a href="/tutorial/input-output-controller/configure-the-ioc-with-node-red.html">Configure the IOC With Node-Red</a></li>
				</ul>
				<a href="/tutorial/input-output-controller/setup-the-beaglebone-wireless.html"><h1>Setup the BBBW</h1></a>
				<ul>
				 	<li><a href="/tutorial/input-output-controller/setup-the-beaglebone-wireless/backup-the-flash-memory-of-the-bbbw.html">Backup the BBBW</a></li>
				 	<li><a href="/tutorial/input-output-controller/setup-the-beaglebone-wireless/change-the-passwords.html">Change the Passwords</a></li>
				 	<li><a href="/tutorial/input-output-controller/setup-the-beaglebone-wireless/change-the-host-name.html">Change the host name</a></li>
				 	<li><a href="/tutorial/input-output-controller/setup-the-beaglebone-wireless/setup-the-wireless.html">Setup the wireless</a></li>
				 	<li><a href="/tutorial/input-output-controller/setup-the-beaglebone-wireless/configure-node-red.html">Configure Node-Red</a></li>
				</ul>
			</div>
			<div class="clearer"><span /></div>
			<div class="footer"><p>yggdrasilView</p></div>
		</div>
	</body>
</html>
